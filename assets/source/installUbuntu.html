<!-- ハンバーガーメニュー -->
        <button id="hamburger" class="hamburger" aria-label="メニューを開く">
            <span></span>
            <span></span>
            <span></span>
        </button>

        <!-- オーバーレイ -->
        <div id="sidebarOverlay" class="sidebar-overlay"></div>

        <div class="container">
            <!-- サイドバー（目次） -->
            <nav class="sidebar">
                <h3>目次</h3>
                <ul class="toc">
<li><a href="#1">Ubuntuのインストール</a>
<ul>
<li><a href="#1.1">インストールする前に</a></li>
<li><a href="#1.2">ブートローダーの起動</a></li>
<li><a href="#1.3">言語の選択</a></li>
<li><a href="#1.4">キーボードレイアウトの設定</a></li>
<li><a href="#1.5">アップデートと他のソフトウェア</a></li>
<li><a href="#1.6">インストールの種類</a></li>
<li><a href="#1.7">どこに住んでいますか</a></li>
<li><a href="#1.8">あなたの情報を入力してください</a></li>
<li><a href="#1.9">インストールの開始</a></li>
</ul>
</li>
<li><a href="#2">基本設定</a>
<ul>
<li><a href="#2.1">ログイン</a></li>
<li><a href="#2.2">初期セットアップウィンドウ</a></li>
<li><a href="#2.3">端末の起動</a></li>
<li><a href="#2.4">root パスワードの設定</a></li>
<li><a href="#2.5">rootユーザにログイン</a></li>
<li><a href="#2.6">ネットワークの設定</a></li>
<li><a href="#2.7">各ツール別のプロキシ設定</a></li>
</ul>
</li>
<li><a href="#3">Mail サーバ</a>
<ul>
<li><a href="#3.1">Postfix</a></li>
<li><a href="#3.2">Dovecot（POP3）</a></li>
</ul>
</li>
<li><a href="#4">WEBサーバの構築</a>
<ul>
<li><a href="#4.1">apache2のインストール</a></li>
<li><a href="#4.2">apache2の設定</a></li>
<li><a href="#4.3">コンテンツの設置</a></li>
</ul>
</li>
</ul>
            </nav>

            <!-- メインコンテンツ -->
            <main class="main-content">
                <h1 id="1">Ubuntuのインストール</h1>
<p>UbuntuはLinuxディストリビューションの中でもサーバ向け、デスクトップ向け共に人気の高いディストリビューションです。これからUbuntuをコンピュータにインストールしてメール、ウェブ、ファイル共有、リモートログイン機能を持ったサーバを構築していきます。</p>
<p>今回インストールするバージョンはUbuntu 24.04.2 - Desktopです。</p>

<h2 id="1.1">インストールする前に</h2>
<p>このマニュアルは設定内容と基本説明のみで構成されています。 そのため、コマンドの操作などは実際に調べて設定してもらいます。 コマンドの調べ方は「[コマンドの名前] 操作方法」または「[コマンドの名前] 使い方」で検索してブログ記事やオンラインマニュアルから探してください。</p>

<h2 id="1.2">ブートローダーの起動</h2>
<p>黒い画面が現れたら<code>「Try or Install Ubuntu」</code>に矢印キーでカーソルを合わせて[Enter]</p>
<p>しばらくの時間、起動の準備が行われます。</p>

<h2 id="1.3">言語の選択</h2>
<p>使用する言語を選択します。デフォルトでは[日本語]に設定されているます。</p>
<p>使用する言語に併せて、左のリストを下にスクロールして、言語を選択してください。</p>
<p>言語が選択出来たら[ Ubuntuをインストール ]を選択します。</p>

<h2 id="1.4">キーボードレイアウトの設定</h2>
<p>キーボードの配列を設定します。</p>
<p>デフォルトでは日本語配列になっています。</p>
<p>問題がなければ、[続ける]を選択します。</p>

<h2 id="1.5">アップデートと他のソフトウェア</h2>
<p>[通常のインストール]を選択し、[続ける]を選択します。</p>

<h2 id="1.6">インストールの種類</h2>
<p>[ディスクを削除してUbuntuをインストール]を選択し、[インストール]を選択します。</p>

<p>[ディスクに変更を書き込みますか？]というウィンドウが出現します。問題がなければ、[続ける]を選択します。</p>

<h2 id="1.7">どこに住んでいますか</h2>
<p>時刻の設定をします。  </p>
<p>世界地図で日本にピンが刺されてあり、下の入力欄に「Tokyo」とあったら[続ける]を選択します。</p>

<h2 id="1.8">あなたの情報を入力してください</h2>
<p>表示された項目を以下の表から設定してください。</p>
<table class="table-auto">
<thead>
<tr>
<th>項目</th>
<th>入力値</th>
</tr>
</thead>
<tbody>
<tr>
<td>あなたの名前</td>
<td>tome</td>
</tr>
<tr>
<td>コンピュータの名前</td>
<td><?php echo $serverHostname; ?></td>
</tr>
<tr>
<td>ユーザ名の入力</td>
<td>tome</td>
</tr>
<tr>
<td>パスワードの入力</td>
<td>netsys00</td>
</tr>
<tr>
<td>パスワードの確認</td>
<td>netsys00</td>
</tr>
</tbody>
</table>
<p>[ログイン時にパスワードを要求する]にチェックを付けて[続ける]を選択します。</p>


<h2 id="1.9">インストールの開始</h2>
<p>インストールの準備が完了すると、インストールが開始されます。</p>
<p>インストールにしばらくかかります。</p>

<p>インストールが完了すると[インストールが完了しました]というポップアップと共に、再起動を促されます。</p>

<p>[今すぐ再起動する]を選択して再起動を行います。</p>

<div class="note">
<p><strong>注記:</strong></p>
<p>Ubuntuのロゴとロードマークが表示されながら「Please remove the installation medium, then press ENTER:(インストールメディアを取り出し、ENTER キーを押してください。)」と表示されます。指示通り、Enterを押すとマシンが完全に停止します。</p>
</div>

<p>SCTSのメニューより、「インストールサーバの起動」からUbuntuを選択して再び起動してください。</p>

<h1 id="2">基本設定</h1>

<h2 id="2.1">ログイン</h2>
<p>起動が完了すると、ログイン画面が表示されます。</p>

<p>中央のアイコン[tome]をクリックして、設定したパスワード[netsys00]を入力してEnterを押してログインします。</p>

<h2 id="2.2">初期セットアップウィンドウ</h2>
<p>初めてログインをすると、Livepathchセキュリティのセットアップが表示されます。</p>
<p>左の[次へ]をクリックしてください。</p>
<p>・Livepatchセキュリティ</p>
<p>・Ubuntuの改善</p>
<p>　はい、システム情報をCanonicalに送信します。</p>
<p>・プライバシー位置情報(default:off)</p>
<p>・準備が完了しました→(完了)</p>


<h3 id="2.2.1">Proxyの設定</h3>

<p>設定→ネットワークより、<strong>ネットワークプロキシ</strong>を選択して、無効から<strong>手動</strong>に変更して、以下の項目を入力します。</p>
<table class="table-fixed">
<thead>
<tr>
<th>項目名</th>
<th>入力値</th>
<th>ポート</th>
</tr>
</thead>
<tbody>
<tr>
<td>HTTPプロキシ</td>
<td>proxy-a.t-kougei.ac.jp</td>
<td>8080</td>
</tr>
<tr>
<td>HTTPSプロキシ</td>
<td>proxy-a.t-kougei.ac.jp</td>
<td>8080</td>
</tr>
<tr>
<td>FTPプロキシ</td>
<td>proxy-a.t-kougei.ac.jp</td>
<td>8080</td>
</tr>
<tr>
<td>Socksホスト</td>
<td>proxy-a.t-kougei.ac.jp</td>
<td>8080</td>
</tr>
<tr>
<td>次のホストを無視する</td>
<td>*.t-kougei.ac.jp</td>
<td>-</td>
</tr>
</tbody>
</table>

<h2 id="2.3">端末の起動</h2>
<p>左下端の[アプリケーション]アイコンをクリックして項目の中から[端末]をクリックします。または[検索キーワード入力]から[Terminal]と入力して[端末]をクリックしします。</p>

<div class="hint">
<p><strong>ヒント:</strong></p>
<p><code>Ctrl+Alt+T</code>でもターミナルが開けます</p>
</div>

<h2 id="2.4">root パスワードの設定</h2>
<p>端末を開き、root のパスワードを設定します。</p>

<pre><code class="language-bash">tome@<?php echo $serverHostname; ?>:~$ sudo passwd root [Enter]
tomeのパスワード:
新しいパスワード:(tomeと同じ)
新しいパスワードを再入力してください:(tomeと同じ)</code></pre>
<div class="caution">
<p><strong>注意:</strong></p>
<p>パスワードの入力中は文字が何も表示されません。</p>
<p>キーボードで入力したら、Enterを押してください。</p>
</div>

<h2 id="2.5">rootユーザにログイン</h2>
<p>現在はtomeにログインしていますが、今後、rootで作業するために、rootにログインを行います。</p>
<pre><code class="language-bash">tome@<?php echo $serverHostname; ?>:~$ su -
パスワード:
root@<?php echo $serverHostname; ?>:~#</code></pre>
<p>root権限ではシェルの記号が<code>$</code>から<code>#</code>に表記が変わります。</p>
<p>root権限ではシステムの全ての権限を保持しているので、慎重に操作してください。</p>

<h2 id="2.6">ネットワークの設定</h2>
<p>nmtuiを起動してネットワークの設定を行います。</p>
<pre><code class="language-bash">root@<?php echo $serverHostname; ?>:~# nmtui</code></pre>

<p><code>接続の編集</code>-><code>編集</code>でネットワークの設定ファイルの編集を行います。</p>
<pre><code>nmtuiでは基本、十字キーとEnterキーで操作します。</code></pre>

<p><strong>IPv4の設定</strong>の<code><strong>自動</strong></code>を[Enter]して<code><strong>手作業</strong></code>に変更します。</p>
<p>右の<code><strong><表示する></strong></code>にカーソルを合わせて[Enter]を押します。</p>

<p>次の項目に以下を記入します。</p>
<table class="table-fixed">
<thead>
<tr>
<th>項目名</th>
<th>入力値</th>
</tr>
</thead>
<tbody>
<tr>
<td>アドレス</td>
<td><?php echo $serverIP; ?></td>
</tr>
<tr>
<td>ゲートウェイ</td>
<td><?php echo $gatewayIP; ?></td>
</tr>
<tr>
<td>DNSサーバー</td>
<td><?php echo $gatewayIP; ?></td>
</tr>
<tr>
<td>検索ドメイン</td>
<td>netsys.cs.t-kougei.ac.jp</td>
</tr>
<tr>
<td>検索ドメイン</td>
<td>cs.t-kougei.ac.jp</td>
</tr>
<tr>
<td>検索ドメイン</td>
<td>t-kougei.ac.jp</td>
</tr>
</tbody>
</table>

<p>次に<strong>IPv6の設定</strong>の<code><strong>自動</strong></code>を[Enter]して<code><strong>無効</strong></code>に変更します。</p>

<p>すべての設定が終わったら、一番下の<code><strong><ＯＫ></strong></code>を選択して、[Enter]を押します。</p>
<p><code><strong><戻る></strong></code>を押して、一番最初に戻ります。</p>

<h3 id="2.6.2">ホスト名の設定</h3>
<p><code>nmtui</code>の一番最初のオプション選択メニューから<code>システムのホスト名を設定する</code>を選択します。</p>
<p>ホスト名を<code><?php echo $serverHostname; ?></code>を<code><?php echo $serverHostname; ?>.cs.t-kougei.ac.jp</code>に変更して<code><strong><ＯＫ></strong></code>を[Enter]します。</p>

<p>「ホスト名を'<?php echo $serverHostname; ?>.cs.t-kougei.a.cjp'に設定します」と表示されたら完了です。<code><strong><ＯＫ></strong></code>を[Enter]します。</p>

<p>すべての設定が完了したら一番最初のオプション選択メニューの最後にあ<code><strong><ＯＫ></strong></code>を[Enter]します。</p>

<h3 id="2.6.3">ネットワークの設定の確認</h3>
<p>ipコマンドを使用して正しくネットワークに接続できているか確認します。</p>
<pre><code class="language-bash">root@<?php echo $serverHostname; ?>:~# ip a [Enter]</code></pre>

<p>ネットワークデバイス、<code>enp1s0</code>の<code>inet</code>が<code><?php echo $serverIP; ?>/24</code>とあれば正しく設定されています。</p>
<p>また、enp1s0にipv6の項目がなければ、ipv6を無効に設定できています。</p>

<h3 id="2.6.4">ホスト名の設定の確認</h3>
<pre><code class="language-bash">root@<?php echo $serverHostname; ?>:~$ cat /etc/hostname [Enter]</code></pre>
<p>これでホスト名が正しく表示された、ホスト名の設定は完了です。</p>

<h2 id="2.7">各ツール別のプロキシ設定</h2>

<h3 id="2.7.5">NetworkMangaerのプロキシ設定</h3>
<p>右上の電源アイコンをクリックして、表示された項目欄から[設定]を選択します。</p>
<p>ネットワークの設定項目のうち<code>ネットワークプロキシ</code>をの歯車マークをクリックします。</p>
<p><strong>無効</strong>から<strong>手動</strong>に変更して、以下の項目を入力します。</p>
<table class="table-fixed">
<thead>
<tr>
<th>項目名</th>
<th>入力値</th>
<th>ポート</th>
</tr>
</thead>
<tbody>
<tr>
<td>HTTPプロキシ</td>
<td>proxy-a.t-kougei.ac.jp</td>
<td>8080</td>
</tr>
<tr>
<td>HTTPSプロキシ</td>
<td>proxy-a.t-kougei.ac.jp</td>
<td>8080</td>
</tr>
<tr>
<td>FTPプロキシ</td>
<td>proxy-a.t-kougei.ac.jp</td>
<td>8080</td>
</tr>
<tr>
<td>Socksホスト</td>
<td>proxy-a.t-kougei.ac.jp</td>
<td>8080</td>
</tr>
<tr>
<td>次のホストを無視する</td>
<td>*.t-kougei.ac.jp</td>
<td>-</td>
</tr>
</tbody>
</table>

<p>入力が完了したら×で閉じます。</p>
<p>設定ウィンドウも×で閉じます。</p>

<h3 id="2.7.6">bashのプロキシ設定</h3>
<p>再び端末に戻って設定を行います。  </p>
<p>新たに<code>/etc/profile.d/proxy.sh</code>ファイルを作成してプロキシ設定を記述します。</p>

<pre><code class="language-bash">root@<?php echo $serverHostname; ?>:~$ vi /etc/profile.d/proxy.sh</code></pre>

<div class="hint">
<p><strong>ヒント:</strong></p>
<p>viエディタは通常モードで「h」で左に移動、「j」で下に移動、「k」で上に移動、「l」で右に移動。  </p>
<p>「i」で入力モードに切り替える。「Esc」を押して通常モードに戻る。</p>
<p>通常モードで「:w」で保存「:q」で終了、「:wq」で保存して終了。</p></p>
<p></div>  </p>

<pre><code>HTTP_PROXY=http://proxy-a.t-kougei.ac.jp:8080
HTTPS_PROXY=http://proxy-a.t-kougei.ac.jp:8080

http_proxy=http://proxy-a.t-kougei.ac.jp:8080
https_proxy=http://proxy-a.t-kougei.ac.jp:8080</code></pre>

<p>sourceコマンドで作成した設定ファイルを読み込ませます。</p>

<pre><code class="language-bash">root@<?php echo $serverHostname; ?>:~$ source /etc/profile.d/proxy.sh</code></pre>
<h3 id="2.7.7">aptのプロキシ設定</h3>
<pre><code class="language-bash">root@<?php echo $serverHostname; ?>:~$ vi /etc/apt/apt.conf</code></pre>

<p>以下を記述します。</p>

<pre><code>Acquire::http::Proxy "http://proxy-a.t-kougei.ac.jp:8080";
Acquire::https::Proxy "http://proxy-a.t-kougei.ac.jp:8080";</code></pre>

<h3 id="2.7.8">パッケージの更新とインストール</h3>
<pre><code class="language-bash">root@<?php echo $serverHostname; ?>:~$ apt update</code></pre>
<p>先頭にステータスが表示されます。<strong>取得</strong>と表示されていれば</p>
<p>既存のリポジトリからパッケージの更新がされていることを意味します。</p>
<p><strong>取得</strong>の文字が確認できたら成功です。</p>

<div class="note">
<p><strong>注記:</strong></p>
<p>パッケージの更新後に、「ソフトウェアの更新」というポップアップがされる時があります。<strong>「後で通知する」</strong>を選択して、消しましょう。</p>
</div>

<p>パッケージのインストールをします。</p>
<pre><code class="language-bash">root@<?php echo $serverHostname; ?>:~$ apt install</code></pre>
<p><div class="note"></p>
<p><p><strong>注記:</strong></p></p>
<p><p>インストールは時間がかかるので気長に待ちましょう</p>
</div>

<h1 id="3">Mail サーバ</h1>

<p>Mailサーバはメールの送受信を行うためのサーバです。  </p>

<h2 id="3.1">Postfix</h2>
<p>メールの送信には<strong>Postfix</strong>が、受信には<strong>Davcot</strong>が使用されます。  </p>

<h3 id="3.1.9">Postfix のインストール</h3>

<pre><code class="language-bash">tome@<?php echo $serverHostname; ?>:~$ sudo apt -y install postfix</code></pre>

<p>インストーラで「インターネットサイト」を選択し、ホスト名を確認します。</p>

<h3 id="3.1.10">postfixの設定</h3>
<p>postfixの設定ファイルである<code>/etc/postfix/main.cf</code>を<code>vi</code>エディタで編集します。</p>

<pre><code class="language-bash">tome@<?php echo $serverHostname; ?>:~$ sudo vi /etc/postfix/main.cf</code></pre>

<p>以下の設定を行います。</p>

<pre><code>myhostname = <?php echo $serverHostname; ?>.netsys.cs.t-kougei.ac.jp
mydomain = netsys.cs.t-kougei.ac.jp
myorigin = $mydomain
mydestination = $myhostname, localhost.$mydomain, localhost, $mydomain
relayhost = [smtp-a.t-kougei.ac.jp]
mynetworks = 127.0.0.0/8
inet_interfaces = all
inet_protocols = ipv4
home_mailbox = Maildir/</code></pre>

<p>参考:</p>
<ul>
<li><code>myorigin</code>: 外行きメールに使うドメイン</li>
<li><code>mydestination</code>: 受信するドメイン</li>
<li><code>mynetworks</code>: メールリレーを許可するネットワーク</li>
</ul>
<h3 id="3.1.11">postfixの設定の反映</h3>
<p><code>systemctl</code>コマンドでpostfixを再起動します。</p>

<pre><code class="language-bash">tome@<?php echo $serverHostname; ?>:~$ sudo systemctl restart postfix.service</code></pre>

<h3 id="3.1.12">メール転送の設定</h3>
<p><code>/etc/aliases</code>ファイルに、 <code>転送元: 転送先</code> を指定することでメールを自動的に転送することができます。</p>
<pre><code class="language-bash">tome@<?php echo $serverHostname; ?>:~$ sudo vi /etc/aliases</code></pre>

<p><code>/etc/aliases</code>ファイルに下記を記述します。</p>
<pre><code>root: kitamura@st.t-kougei.ac.jp</code></pre>

<p><code>newaliases</code>コマンドで、<code>/etc/aliases</code>ファイルの設定を反映させます。</p>
<pre><code class="language-bash">sudo newaliases</code></pre>

<h3 id="3.1.13">メール送受信確認（ローカル）</h3>

<p>mailコマンドをインストールしてメールの送信テストをします。</p>

<h4 id="3.1.14">mailコマンドのインストール</h4>
<pre><code class="language-bash">tome@<?php echo $serverHostname; ?>:~$ sudo apt -y install mailutils</code></pre>

<h4 id="3.1.15">mailコマンドでtomeに送信</h4>
<p><code>mail</code>コマンドでtomeに「Test」というメッセージを送ります。  </p>
<pre><code class="language-bash">tome@<?php echo $serverHostname; ?>:~$ echo "test" | mail tome</code></pre>

<p><code>/home/tome/Maildi/new</code>ディレクトリに新しくファイルが作成されており、ファイルの内容が「Test」とあれば、成功です。</p>
<pre><code class="language-bash">tome@<?php echo $serverHostname; ?>:~$ ls /home/tome/Maildir/new</code></pre>

<h4 id="3.1.16">SMTP レベルでの確認（任意）:</h4>

<p><code>telnet</code>コマンドでSMTPが起動しているか確認します。</p>
<pre><code class="language-bash">tome@<?php echo $serverHostname; ?>:~$ telnet localhost 25
> quit</code></pre>

<h2 id="3.2">Dovecot（POP3）</h2>
<p>Dovecotは、IMAPおよびPOP3の両方のプロトコルに対応したオープンソースのメール受信サーバです。</p>

<h3 id="3.2.17">Dovecotのインストール</h3>
<pre><code class="language-bash">tome@<?php echo $serverHostname; ?>:~$ sudo apt -y install dovecot-core dovecot-pop3d</code></pre>

<h3 id="3.2.18">Dovecotの設定</h3>
<p>Dovcotの設定ファイルである<code>/etc/dovecot/conf.d/10-ssl.conf</code>ファイルをviエディタで開きます。</p>
<pre><code class="language-bash">tome@<?php echo $serverHostname; ?>:~$ sudo vi /etc/dovecot/conf.d/10-ssl.conf</code></pre>

<p>SSLを無効にします。</p>

<pre><code>ssl = no</code></pre>
<p>Dovcotの設定ファイルである<code>/etc/dovecot/conf.d/10-auth.conf</code>ファイルをviエディタで開きます。</p>

<pre><code class="language-bash">tome@<?php echo $serverHostname; ?>:~$ sudo vi /etc/dovecot/conf.d/10-auth.conf</code></pre>

<p>プレーンテキスト認証を許可します。</p>

<pre><code>disable_plaintext_auth = no</code></pre>

<p>Dovcotの設定ファイルである<code>/etc/dovecot/conf.d/10-mail.conf</code>ファイルをviエディタで開きます。</p>

<pre><code class="language-bash">tome@<?php echo $serverHostname; ?>:~$ sudo vi /etc/dovecot/conf.d/10-mail.conf</code></pre>

<p><code>mail_location</code> を <code>maildir</code> に変更します。</p>

<pre><code># mail_location = mbox:~/mail:INBOX=/var/mail/%u
mail_location = maildir:~/Maildir</code></pre>

<h3 id="3.2.19">Dovecotの設定の反映</h3>
<p><code>systemctl</code>コマンドでdovecotを再起動します。</p>

<pre><code class="language-bash">tome@<?php echo $serverHostname; ?>:~$ sudo systemctl restart dovecot</code></pre>

<h3 id="3.2.20">client1からの POP3 動作確認</h3>
<p>cilent1を起動して、client1から</p>
<p><code>telnet</code>コマンドを使用してメールの受信を確認します。</p>

<pre><code class="language-bash">tome@client1:~$ telnet <?php echo $serverHostname; ?> 110
user tome
pass netsys00
list
retr 1
dele 1
quit</code></pre>

<h1 id="4">WEBサーバの構築</h1>

<h2 id="4.1">apache2のインストール</h2>

<p>aptコマンドでapache2をインストールします。</p>

<pre><code>root@<?php echo $serverHostname; ?>:~$ apt install apache2</code></pre>

<h2 id="4.2">apache2の設定</h2>
<pre><code class="language-bash">root@<?php echo $serverHostname; ?>:~$ vi /etc/apache2/apache2.conf</code></pre>

<p>サーバの名前とポート番号を記載します。</p>

<div class="code-file-info">📁 /etc/httpd/conf/httpd.conf</div>
<pre><code>ServerName <?php echo $serverHostname; ?>.netsys.cs.t-kougei.ac.jp:80</code></pre>

<h2 id="4.3">コンテンツの設置</h2>
<p>サーバが提供するコンテンツを<code>/var/www/html/</code>に設置します。ファイル名は<code>index.html</code>とします。</p>

<pre><code class="language-bash">root@<?php echo $serverHostname; ?>:~$ vi /var/www/html/index.html</code></pre>

<div class="code-file-info">📁 /var/www/html/index.html</div>
<pre><code>hello world</code></pre>

<h3 id="4.3.21">クライアントからの確認</h3>

            </main>
        </div>