<div class="container">
        <!-- サイドバー（目次） -->
        <nav class="sidebar">
            <h3>目次</h3>
            <ul class="toc">
<li><a href="#1">RockyLinuxについて</a>
<ul>
<li><a href="#1.1">序章</a></li>
</ul>
</li>
<li><a href="#2">RockyLinuxのインストール</a>
<ul>
<li><a href="#2.1">言語選択</a></li>
<li><a href="#2.2">ディスクパーティション</a></li>
<li><a href="#2.3">Kdump</a></li>
<li><a href="#2.4">ネットワーク設定</a></li>
<li><a href="#2.5">NTPの設定</a></li>
<li><a href="#2.6">追加ソフトウェアの選択</a></li>
<li><a href="#2.7">rootパスワードの設定</a></li>
<li><a href="#2.8">ユーザーの作成</a></li>
<li><a href="#2.9">インストールの開始</a></li>
</ul>
</li>
<li><a href="#3">初期設定</a>
<ul>
<li><a href="#3.1">ログイン</a></li>
<li><a href="#3.2">デスクトップアイコンの設定</a></li>
<li><a href="#3.3">Firefoxの設定</a></li>
</ul>
</li>
<li><a href="#4">コンピュータの設定</a>
<ul>
<li><a href="#4.1">入力方式の設定</a></li>
<li><a href="#4.2">ネットワークの設定</a></li>
<li><a href="#4.3">電源の設定</a></li>
</ul>
</li>
<li><a href="#5">サーバの設定</a>
<ul>
<li><a href="#5.1">SELinuxの無効化</a></li>
<li><a href="#5.2">yumの設定</a></li>
</ul>
</li>
<li><a href="#6">NFSクライアント</a>
<ul>
<li><a href="#6.1">NFSのマウント</a></li>
<li><a href="#6.2">マウントの確認</a></li>
<li><a href="#6.3">NFSのアンマウント</a></li>
</ul>
</li>
<li><a href="#7">メールサーバの構築</a>
<ul>
<li><a href="#7.1">Postfix</a></li>
<li><a href="#7.2">Dovecot（POP3）</a></li>
</ul>
</li>
<li><a href="#8">WEBサーバの構築</a></li>
<li><a href="#9">SSHの設定</a></li>
<li><a href="#10">Firewallの設定</a></li>
<li><a href="#11">リモートアクセスの設定</a>
<ul>
<li><a href="#11.1">rloginとrshの設定</a></li>
<li><a href="#11.2">sshの設定</a></li>
</ul>
</li>
</ul>
        </nav>

        <!-- メインコンテンツ -->
        <main class="main-content">
            <h1 id="1">RockyLinuxについて</h1>

<p>RockyLinuxは、Red Hat EnterpriseLinux(RHEL)のダウンストリーム版であるCentOSの開発が中止され、CentOS創設者であるGregory Kurtzer氏がプロジェクトを立ち上げたLinuxディストリビューションです。開発はRockyLinux Projectで行われており、2021年から正式なリリースが行われています。</p>

<h2 id="1.1">序章</h2>

<p>OSのインストール練習として、RockyLinuxのインストールを行います。</p>

<h1 id="2">RockyLinuxのインストール</h1>

<h2 id="2.1">言語選択</h2>
<p>インストールが開始されると言語選択メニューが表示されます。左のメニューの中央付近にある[日本語]を選択し、[続行]を選択します。</p>

<h2 id="2.2">ディスクパーティション</h2>
<p>インストール先のディスクパーティションの設定を行います。[インストール先]を選択し、その他のストレージオプションから、[カスタム]にチェックを入れ、[完了]を選択します。</p>

<p>その後、以下のような画面が表示されるため、[+]を選択し、マウントポイントに/bootを選択、割り当てる領域に512MBを入力し、[マウントポイントの追加]を選択します。</p>

<p>再度、[+]を選択し、マウントポイントにswapを選択、割り当てる領域に2GBを入力し、[マウントポイントの追加]を選択します。さらに、[+]を選択し、マウントポイントに/を選択、割り当てる領域は空欄にし、[マウントポイントの追加]を選択します。</p>

<p>その後、[完了]をクリックし、[変更の概要]ウィンドウより[変更を許可する]を選択します。</p>

<h2 id="2.3">Kdump</h2>
<p>Kdumpの無効化を行うために、[KDUMP]を選択し、[kdumpを有効にする]のチェックを外し、[完了]を選択します。</p>

<h2 id="2.4">ネットワーク設定</h2>
<p>次に、ネットワークの設定を行います。[ネットワークとホスト名]を選択し、ホスト名に<code>{{serverHostname}}.netsys.cs.t-kougei.ac.jp</code>を入力します。</p>

<p>ホスト名入力後、[適用]をクリックします。</p>
<p>ここで、[適用]をクリックしないと設定が反映されないため注意してください。</p>

<p>さらに、[設定]を選択し、[IPv4のセッティング]をクリックし、方式を自動(DHCP)から手動に変更します。</p>

<p>アドレスの[追加]を選択し、アドレスに<code>{{serverIP}}</code>、ネットマスクに255.255.255.0、ゲートウェイに<code>{{gatewayIP}}</code>を入力します。</p>

<p>DNSサーバに<code>{{gatewayIP}}</code>、ドメインを検索に<code>netsys.cs.t-kougei.ac.jp,cs.t-kougei.ac.jp,t-kougei.ac.jp</code>を入力し、[保存]を選択します。</p>

<p>保存後、右上の[オフ]を[オン]に変更し、IPアドレスなどが表示されているか確認し、[完了]を選択します。</p>

<h2 id="2.5">NTPの設定</h2>

<h2 id="2.6">追加ソフトウェアの選択</h2>
<p>インストールするソフトウェアの選択を行います。[ソフトウェアの選択]を選択し、ベース環境は[サーバー(GUI使用)]を選択します。</p>
<p>選択した環境用のその他のソフトウェアは以下を選択します。</p>
<ul>
<li>DNSネームサーバー</li>
<li>ファイルとストレージサーバー</li>
<li>FTPサーバー</li>
<li>メールサーバー</li>
<li>ネットワークファイルシステムクライアント</li>
<li>レガシーなUNIX互換性</li>
</ul>
<p>開発ツールにチェックを入れ[完了]を選択します。</p>

<h2 id="2.7">rootパスワードの設定</h2>
<p>rootのパスワードには、指定されたパスワード[netsys00]を入力し、[完了]を選択します。</p>

<p>［このパスワードは辞書チェックに失敗しました］と表示されますが、この場合完了を2回クリックします。</p>

<h2 id="2.8">ユーザーの作成</h2>
<p>ユーザーtomeを作成します。</p>

<table class="table-auto">
<thead>
<tr>
<th>項目名</th>
<th>入力値</th>
</tr>
</thead>
<tbody>
<tr>
<td>ユーザネーム</td>
<td>tome</td>
</tr>
<tr>
<td>ユーザー名</td>
<td>tome</td>
</tr>
<tr>
<td>パスワード</td>
<td>netsys00</td>
</tr>
<tr>
<td>パスワードの確認</td>
<td>netsys00</td>
</tr>
</tbody>
</table>

<p>rootのパスワードと同様に［このパスワードは辞書チェックに失敗しました］と表示されますが、この場合完了を2回クリックします。</p>

<h2 id="2.9">インストールの開始</h2>
<p>全ての設定項目が完了したら、[インストールの開始]を選択します。</p>
<div class="note">
<p><strong>注記:</strong></p>
<p>インストールには時間がかかるため、終わるまで待機してください。</p>
</div>

<p>インストールが完了したら、[システムの再起動]を選択して、サーバを再起動します。</p>
<p>サーバが停止したら、SCTSメニューより、[インストールサーバの起動]->[RockyLinux]でサーバを起動します。</p>

<h1 id="3">初期設定</h1>

<h2 id="3.1">ログイン</h2>
<p>ライセンスに同意後、ログイン画面が表示されるため、ログインを行います。rootでログインを行うため、[アカウントが見つかりませんか？]を選択しrootでログインします。</p>

<p>ユーザ名の入力後、右下にある歯車のマークをクリックし、GNOMEクラシックを選択します。</p>
<p>選択を完了したらパスワードを入力し、ログインします。</p>

<table class="table-auto">
<thead>
<tr>
<th>項目名</th>
<th>入力値</th>
</tr>
</thead>
<tbody>
<tr>
<td>ユーザネーム</td>
<td>root</td>
</tr>
<tr>
<td>パスワード</td>
<td>netsys00</td>
</tr>
</tbody>
</table>

<h2 id="3.2">デスクトップアイコンの設定</h2>
<p>デフォルト設定だとデスクトップアイコンの表示が大きいため、小さくします。  </p>
<p>右上の<code>[アプリケーション]</code>-><code>[ファイル]</code>を選択します。</p>

<p>画面右側上部にある三本線マークの隣の<code>[▼]ボタン</code>からプルダウンを行い、[-]をクリックし、50%にします。</p>

<p>次に、デスクトップ画面にfirefoxと端末を配置します。</p>
<p>ファイルマネージャーより、左の項目欄末尾にある<code>[他の場所]</code>を選択し、<code>[コンピューター]</code>から<code>[usr]</code>-><code>[share]</code>-><code>[applications]</code>の順でクリックします。</p>

<p><code>[applications]</code>ディレクトリから、<code>org.gnome.Termianl.desktop</code>と<code>firefox.desktop</code>を探し出し、デスクトップに貼り付けます。</p>
<p>貼り付けには、[ctrl]+[c]、[ctrl]+[v]もしくは[右クリック]、[コピー]、[貼り付け]を使用します。</p>
<p>ドラッグ＆ドロップではできません。</p>

<p>ファイルマネージャは必要ないため閉じます。</p>

<p>デスクトップに配置した、firefoxと端末のファイルをそれぞれ、右クリックし、[起動を許可する]を選択します。</p>
<p>正常であれば、アイコンが正しく表示されるようになります。</p>

<h2 id="3.3">Firefoxの設定</h2>
<p>firefoxを起動して右上の[三本線]をクリックし、[設定]を選択します。</p>

<h3 id="3.3.1">カスタムホームページの設定</h3>

<p>[ホーム]->[ホームページ]よりカスタムURLを設定します。  </p>
<p>[ホームページと新しいウィンドウ]に<code>http://www.cs.t-kougei.ac.jp/netsys</code>を記入します。</p>

<h3 id="3.3.2">プロキシの設定</h3>

<p>ネットワークプロキシ設定を行います。設定画面の<code>[一般]</code>から設定画面の一番下にある<code>[接続設定]</code>を選択します。</p>
<p><code>[手動でプロキシを設定する]</code>のボタンを選択し、以下の項目を入力します。。</p>

<table class="table-fixed">
<thead>
<tr>
<th>項目名</th>
<th>入力値</th>
<th>ポート</th>
</tr>
</thead>
<tbody>
<tr>
<td>HTTPプロキシー</td>
<td>proxy-a.t-kougei.ac.jp</td>
<td>8080</td>
</tr>
</tbody>
</table>

<p><code>[このプロキシーを HTTPSでも使用する]</code>にチェックを入れます。</p>

<p>次に、<code>[プロキシなしで接続]</code>に<code>*.t-kougei.ac.jp</code>を記入し、[OK]をクリックします。</p>

<h3 id="3.3.3">設定確認</h3>
<p>ホームボタン、または新規タブで、ネットワークシステム研究室のホームページが表示されれば正しく設定されています。  </p>
<p>Firefoxはもう必要ないため、×ボタンで閉じます。</p>

<h1 id="4">コンピュータの設定</h1>

<h2 id="4.1">入力方式の設定</h2>
<p>入力方式の設定を行います。  </p>
<p>右上の<code>[アプリケーション]->[ユーティリティ]->設定</code>を選択して、設定画面を起動します。</p>
<p>左の項目欄から<code>[keyboard]</code>を選択し、<code>[入力ソース]</code>項目より<code>[日本語]</code>下にある<code>[＋]</code>マークを選択します。次に、<code>[入力ソースの追加]</code>メニューから<code>[日本語]</code>を選択し、<code>[日本語(Anthy)]</code>を追加します。</p>

<p>右上日付の隣のトレイバーにある<code>[ja]</code>をクリックし、<code>[日本語(Anthy)]</code>を選択します。</p>

<h2 id="4.2">ネットワークの設定</h2>
<p>設定より<code>[ネットワーク]</code>を選択します。</p>

<h3 id="4.2.4">IPv6の無効化</h3>
<p>[有線]の[歯車マーク]をクリックし、[IPv6]項目を選択し、<code>IPv6メゾット</code>を<code>無効</code>にして適用します。</p>

<h3 id="4.2.5">プロキシの設定</h3>
<p>ネットワークプロキシの[歯車マーク]をクリックし、[手動]を選択し以下を記入します。</p>

<table class="table-fixed">
<thead>
<tr>
<th>項目名</th>
<th>入力値</th>
<th>ポート</th>
</tr>
</thead>
<tbody>
<tr>
<td>HTTPプロキシ</td>
<td>proxy-a.t-kougei.ac.jp</td>
<td>8080</td>
</tr>
<tr>
<td>HTTPSプロキシ</td>
<td>proxy-a.t-kougei.ac.jp</td>
<td>8080</td>
</tr>
<tr>
<td>FTPプロキシ</td>
<td>proxy-a.t-kougei.ac.jp</td>
<td>8080</td>
</tr>
<tr>
<td>Socksホスト</td>
<td>proxy-a.t-kougei.ac.jp</td>
<td>8080</td>
</tr>
<tr>
<td>次のホストを無視する</td>
<td>*.t-kougei.ac.jp</td>
<td>-</td>
</tr>
</tbody>
</table>

<p>入力が完了したら×で閉じます。</p>

<h2 id="4.3">電源の設定</h2>
<p>設定より[電源]を選択し、Screen Blankを[Never]に変更します。</p>

<p>すべての設定項目を終えたら、設定画面を×で閉じます。  </p>

<h1 id="5">サーバの設定</h1>
<p>サーバとしての設定を行うために、デスクトップから[端末]を起動します。</p>

<h2 id="5.1">SELinuxの無効化</h2>
<p>SELinuxの無効化を行います。</p>

<div class="warning">
<p><strong>警告:</strong></p>
<p>この設定にミスがあるとコンピュータが起動しなくなる可能性があるため注意してください。</p>
</div>

<pre><code class="language-bash">vi /etc/selinux/config</code></pre>

<p>以下を変更:</p>
<pre><code>SELINUX=disabled</code></pre>
<h2 id="5.2">yumの設定</h2>
<p>パッケージマネージャーyumの設定を行います。</p>

<pre><code class="language-bash">vi /etc/yum.conf</code></pre>

<p><code>skip_if_unavailable=False</code>の下に以下を記入:</p>
<pre><code>proxy=http://proxy-a.t-kougei.ac.jp:8080/
timeout=900</code></pre>

<p>保存して終了後アップデートを行います。</p>

<pre><code class="language-bash">yum -y update --nobest</code></pre>

<h1 id="6">NFSクライアント</h1>
<p>NFSはネットワーク上でファイルの送受信を行うためのプロトコルです。</p>

<p>NFSクライアントはNFSサーバからファイルを取得するためのソフトです。</p>

<p>今回はjpc1をマウントするためにルートディレクトリに<code>/jpc1</code>を作成します。</p>

<h2 id="6.1">NFSのマウント</h2>
<pre><code class="language-bash">mkdir /jpc1
mount -t nfs jpc1.cs.t-kougei.ac.jp /jpc1</code></pre>

<h2 id="6.2">マウントの確認</h2>
<pre><code class="language-bash">df</code></pre>

<p><code>df</code>コマンドでjpc1がマウントされているか確認します。</p>

<h2 id="6.3">NFSのアンマウント</h2>
<pre><code class="language-bash">umount /jpc1</code></pre>

<p><code>umount</code>コマンドでjpc1をアンマウントします。</p>

<h1 id="7">メールサーバの構築</h1>

<h2 id="7.1">Postfix</h2>

<h3 id="7.1.6">Postfix のインストール</h3>
<p>OSのインストールで既にPostfixをインストールしていますが、チェック項目を忘れていた場合は以下のコマンドでインストールしてください。</p>

<pre><code class="language-bash">yum -y install postfix</code></pre>

<h3 id="7.1.7">Postfixの設定</h3>

<p>postfixの設定ファイルである<code>/etc/postfix/main.cf</code>を<code>vi</code>エディタで編集します。</p>

<pre><code class="language-bash">vi /etc/postfix/main.cf</code></pre>

<p>以下の設定を行います。</p>

<div class="code-file-info">📁 /etc/postfix/main.cf</div>
<pre><code>myhostname = {{serverHostname}}.netsys.cs.t-kougei.ac.jp
mydomain = netsys.cs.t-kougei.ac.jp
myorigin = $mydomain
mydestination = $myhostname, localhost.$mydomain, localhost, $mydomain
relayhost = [smtp-a.t-kougei.ac.jp]
mynetworks = 127.0.0.0/8
inet_interfaces = all
#inet_interfaces = localhost <- 先頭に#を挿入してコメントアウト
inet_protocols = ipv4
home_mailbox = Maildir/</code></pre>

<p>参考:</p>
<ul>
<li><code>myorigin</code>: 外行きメールに使うドメイン</li>
<li><code>mydestination</code>: 受信するドメイン</li>
<li><code>mynetworks</code>: メールリレーを許可するネットワーク</li>
</ul>
<h3 id="7.1.8">postfixの設定の反映</h3>
<p><code>systemctl</code>コマンドでpostfixを再起動します。</p>

<pre><code class="language-bash">systemctl restart postfix.service</code></pre>

<h3 id="7.1.9">メール転送の設定</h3>
<p><code>/etc/aliases</code>ファイルに、 <code>転送元: 転送先</code> を指定することでメールを自動的に転送することができます。</p>
<pre><code class="language-bash">sudo vi /etc/aliases</code></pre>

<p><code>/etc/aliases</code>ファイルに下記を記述します。</p>
<pre><code>root: kitamura@st.t-kougei.ac.jp</code></pre>

<p><code>newaliases</code>コマンドで、<code>/etc/aliases</code>ファイルの設定を反映させます。</p>
<pre><code class="language-bash">sudo newaliases</code></pre>

<h3 id="7.1.10">メール送受信確認（ローカル）</h3>

<p>mailコマンドをインストールしてメールの送信テストをします。</p>

<h4 id="7.1.11">mailコマンドのインストール</h4>
<pre><code class="language-bash">yum -y install s-nail</code></pre>

<h4 id="7.1.12">mailコマンドでtomeに送信</h4>
<p><code>mail</code>コマンドでtomeに「test」というメッセージを送ります。  </p>
<pre><code class="language-bash">echo "test" | mail tome</code></pre>

<p><code>/home/tome/Maildi/new</code>ディレクトリに新しくファイルが作成されており、ファイルの内容が「test」とあれば、成功です。</p>
<pre><code class="language-bash">cat /home/tome/Maildir/new</code></pre>

<h2 id="7.2">Dovecot（POP3）</h2>
<p>Dovecotは、IMAPおよびPOP3の両方のプロトコルに対応したオープンソースのメール受信サーバです。</p>

<h3 id="7.2.13">Dovecotのインストール</h3>
<pre><code class="language-bash">tome@{{serverHostname}}:~$ sudo apt -y install dovecot-core dovecot-pop3d</code></pre>

<h3 id="7.2.14">Dovecotの設定</h3>
<p>Dovcotの設定ファイルである<code>/etc/dovecot/conf.d/10-ssl.conf</code>ファイルをviエディタで開きます。</p>
<pre><code class="language-bash">tome@{{serverHostname}}:~$ sudo vi /etc/dovecot/conf.d/10-ssl.conf</code></pre>

<p>SSLを無効にします。</p>

<pre><code>ssl = no</code></pre>
<p>Dovcotの設定ファイルである<code>/etc/dovecot/conf.d/10-auth.conf</code>ファイルをviエディタで開きます。</p>

<pre><code class="language-bash">tome@{{serverHostname}}:~$ sudo vi /etc/dovecot/conf.d/10-auth.conf</code></pre>

<p>プレーンテキスト認証を許可します。</p>

<pre><code>disable_plaintext_auth = no</code></pre>

<p>Dovcotの設定ファイルである<code>/etc/dovecot/conf.d/10-mail.conf</code>ファイルをviエディタで開きます。</p>

<pre><code class="language-bash">tome@{{serverHostname}}:~$ sudo vi /etc/dovecot/conf.d/10-mail.conf</code></pre>

<p><code>mail_location</code> を <code>maildir</code> に変更します。</p>

<pre><code># mail_location = mbox:~/mail:INBOX=/var/mail/%u
mail_location = maildir:~/Maildir</code></pre>

<h3 id="7.2.15">Dovecotの設定の反映</h3>
<p><code>systemctl</code>コマンドでdovecotを再起動します。</p>

<pre><code class="language-bash">tome@{{serverHostname}}:~$ sudo systemctl restart dovecot</code></pre>

<h3 id="7.2.16">client1からの POP3 動作確認</h3>
<p>cilent1を起動して、client1から</p>
<p><code>telnet</code>コマンドを使用してメールの受信を確認します。</p>

<pre><code class="language-bash"><span class="shell-prompt">tome@client1:~$</span> telnet {{serverHostname}} 110
user tome
pass netsys00
list
retr 1
dele 1
quit</code></pre>

<h1 id="8">WEBサーバの構築</h1>
<h1 id="9">SSHの設定</h1>

<h1 id="10">Firewallの設定</h1>
<p>Firewallサービスが起動しているかの確認を行います。</p>

<pre><code class="language-bash">systemctl status firewalld</code></pre>

<p>出力結果:</p>
<pre><code>● firewalld.service - firewalld - dynamic firewall daemon
Loaded: loaded (/usr/lib/systemd/system/firewalld.service; enabled; vendorpreset: enabled)
Active: active (running) since 水 2021-04-14 10:09:28 JST; 4h 52min ago
Docs: man:firewalld(1)</code></pre>

<p>Activeの項目がactive (running)となっている場合はサービスが起動しているため、OKです。</p>
<p>inactiveとなっている場合は起動していないため、以下のコマンドを実行します。</p>

<pre><code class="language-bash">systemctl start firewalld</code></pre>

<p>再度確認を行い、activeとなっていればOKです。</p>

<p>Firewallの設定確認を行います。</p>

<pre><code class="language-bash">firewall-cmd --list-all</code></pre>

<p>出力結果:</p>
<pre><code>public (active)
target: default
icmp-block-inversion: no
interfaces: ens3
sources:
services: dhcpv6-client ssh
ports:
protocols:
masquerade: no
forward-ports:
source-ports:
icmp-blocks:
rich rules:</code></pre>

<p>必要のないdhcpv6-clientとsshの削除を行います。</p>

<pre><code class="language-bash">firewall-cmd --permanent --remove-service=dhcpv6-client</code></pre>

<pre><code class="language-bash">firewall-cmd --permanent --remove-service=ssh</code></pre>

<p>出力結果:</p>
<pre><code>success</code></pre>

<p>設定の反映を行います。</p>

<pre><code class="language-bash">firewall-cmd --reload</code></pre>

<p>出力結果:</p>
<pre><code>success</code></pre>

<p>再度確認を行い、servicesの項目に消えていればOKです。</p>

<pre><code class="language-bash">firewall-cmd --list-all</code></pre>

<p>出力結果:</p>
<pre><code>public (active)
target: default
icmp-block-inversion: no
interfaces: ens3
sources:
services:
ports:
protocols:
masquerade: no
forward-ports:
source-ports:
icmp-blocks:
rich rules:</code></pre>

<p>Firewallの特定のIPアドレスからのアクセス許可を行います。</p>

<pre><code class="language-bash">firewall-cmd --permanent --add-rich-rule="rule family="ipv4" source address="127.0.0.1/32" accept"</code></pre>

<pre><code class="language-bash">firewall-cmd --permanent --add-rich-rule="rule family="ipv4" source address="{{gatewayIP}}/32" accept"</code></pre>

<pre><code class="language-bash">firewall-cmd --permanent --add-rich-rule="rule family="ipv4" source address="{{clientIP}}/32" accept"</code></pre>

<p>出力結果:</p>
<pre><code>success</code></pre>

<p>設定の反映を行います。</p>

<pre><code class="language-bash">firewall-cmd --reload</code></pre>

<p>出力結果:</p>
<pre><code>success</code></pre>

<p>再度確認を行い、rich rules:の項目に追加したIPアドレスが表示されていればOKです。</p>

<pre><code class="language-bash">firewall-cmd --list-all</code></pre>

<p>出力結果:</p>
<pre><code>public (active)
target: default
icmp-block-inversion: no
interfaces: ens3
sources:
services:
ports:
protocols:
masquerade: no
forward-ports:
source-ports:
icmp-blocks:
rich rules:
rule family="ipv4" source address="127.0.0.1/32" accept
rule family="ipv4" source address="{{gatewayIP}}/32" accept
rule family="ipv4" source address="{{clientIP}}/32" accept</code></pre>

<h1 id="11">リモートアクセスの設定</h1>

<h2 id="11.1">rloginとrshの設定</h2>
<p>rloginとrshのインストールを行います。</p>

<pre><code class="language-bash">yum -y install rsh rsh-server</code></pre>

<p>インストール後、設定を行います。</p>

<pre><code class="language-bash">vi /usr/lib/systemd/system/rsh.socket</code></pre>

<p>以下を変更:</p>
<pre><code>ListenStream=514 → ListenStream=0.0.0.0:514に変更</code></pre>

<pre><code class="language-bash">vi /usr/lib/systemd/system/rlogin.socket</code></pre>

<p>以下を変更:</p>
<pre><code>ListenStream=513 → ListenStream=0.0.0.0:513に変更</code></pre>

<p>設定の反映を行います。</p>

<pre><code class="language-bash">systemctl daemon-reload</code></pre>

<p>rloginとrshの起動と自動起動設定を行います。</p>

<pre><code class="language-bash">systemctl start rsh</code></pre>

<pre><code class="language-bash">systemctl start rlogin</code></pre>

<pre><code class="language-bash">systemctl enable rsh</code></pre>

<pre><code class="language-bash">systemctl enable rlogin</code></pre>

<p>パスワード無しでログインを許可します。</p>

<pre><code class="language-bash">vi /root/.rhosts</code></pre>

<p>以下を記入:</p>
<pre><code>{{gatewayIP}} root
{{gatewayIP}} user1
{{clientIP}} root
{{clientIP}} check</code></pre>

<p>rootユーザでログインを可能にします。</p>

<pre><code class="language-bash">vi /etc/pam.d/rsh</code></pre>

<pre><code class="language-bash">vi /etc/pam.d/rlogin</code></pre>

<p>以下を変更:</p>
<pre><code>#auth require pam_securetty.so ← 先頭の#を削除</code></pre>

<h2 id="11.2">sshの設定</h2>
<p>sshの設定を変更します。</p>

<pre><code class="language-bash">vi /etc/ssh/sshd_config</code></pre>

<p>以下を変更:</p>
<pre><code>#PermitRootLogin Yes → 先頭の#を削除し，PermitRootLogin Noに変更
#PermitEmptyPasswords No ← 先頭の#を削除する</code></pre>

<p>設定の反映を行います。</p>

<pre><code class="language-bash">systemctl restart sshd</code></pre>

<p>以上でOSのインストールと設定は完了となります。</p>


        </main>
    </div>